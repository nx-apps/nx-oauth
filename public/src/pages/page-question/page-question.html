<link rel="import" href="./components/question-list.html">
<link rel="import" href="./components/question-manage.html">

<dom-module id="page-question">
    <template>
        <style include="page-style flex-style">
        </style>
        <div class="xcontainer">
            <div class="container flex-horizontal-with-ratios">
                <div class="flex3child header gl-large">จัดการคำถาม</div>
                <div class="flexchild"></div>
                <div class="flex2child" style="padding: 0px 20px 0px 0px">
                    <gl-combo-box no-lolabel-float placeholder="Module" items="[[module]]" item-label-path="" item-value-path="" value="{{moduleSelect}}">
                        <paper-icon-button icon="remove-circle" class="clear-button"></paper-icon-button>
                    </gl-combo-box>
                </div>
                    
                </div>
        </div>
          
        </div>
        <div class="xcontainer">
            <div class="flex-equal-justified">
                <!--<div class="container">
                    <paper-material elevation="1">
                        <div class="bgWhite" style="padding: 10px">
                    
                        </div>
                    </paper-material>
                </div>-->
            </div>
            <question-list></question-list>
        </div>
        <div class="fixed">
            <paper-fab icon="icons:add" title="นำเข้ารายงาน" on-tap="openPanelRight"></paper-fab>
        </div>
        <panel-right title="{{titleRight}}">
            <question-manage data="{{data}}" status="[[status]]"></question-manage>
        </panel-right>
    </template>
    <script>
        Polymer({
            is: 'page-question',
            behaviors:[nylonBehavior,ReduxBehavior,questionAction,dispatchActionBehavior],
            observers:['_obModuleSelect(moduleSelect)'],
            listeners:{
                'close':'closePanelRight',
                'select-data':'selectList'
            },
            properties:{
                module:{
                    statePath:'commonSystem.module'
                }
            },
            nylonPageActive:function(){
                this.dispatchAction('USER_MANAGE_SELECT_LIST');
            },
            _obModuleSelect:function(ob){
                if(!ob){return}
                this.dispatchAction('QUESTION_GET_LIST',ob);
            },
            selectList:function(e){
                this.titleRight = 'แก้ไขคำถาม';
                this.status = 'update';
                //console.log(e.detail);
                this.data = {
                    user_id:'admin',
                    topic:'',
                    choice:[],
                    tag:[]
                }
                setTimeout(()=>{
                    this.data = e.detail;
                },'20')
                
                this.$$('panel-right').open();
            },
            openPanelRight:function(){
                this.titleRight = 'เพิ่มคำถาม';
                this.data = {
                    user_id:'admin',
                    topic:'',
                    choice:[],
                    tag:[]
                }
                this.status = 'add'
                this.$$('panel-right').open();
            },
            closePanelRight:function(){
                this.$$('panel-right').close();
            }
        });
    </script>
</dom-module>