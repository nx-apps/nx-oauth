
<link rel="import" href="./../../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="./../../../bower_components/iron-image/iron-image.html">
<link rel="import" href="./../components/page-style.html">
<dom-module id="my-app-list">
    <template>
        <style include="page-style">
            tbody>tr>td {
                cursor: pointer;
            }
            
            .app {
                margin: 15px 10px 15px 10px;
                position: relative;
                -webkit-justify-content: center;
                justify-content: center;
                display: inline-block;
                width: 200px;
                cursor: pointer;
                margin-bottom: 30px;

                /*background-color: #3399ff;*/
            }
            
            .app>.item {
                text-align: center;
                font-weight: bold;
            }
            
            .item>a {
                color: #2d6301;
            }
            

            .app[wait] {
                filter: grayscale(100%);
                cursor: default;
            }
            
            .paperLink {
                --paper-icon-button: {
                    color: #2d6301;
                }
                --paper-icon-button-hover: {
                    color: #ff753f;
                }
            }

            .option{
                position: absolute;
                right: 0;
                top:-10px;
            }

        </style>
        <div class="container">
            <template is="dom-repeat" items="[[list]]">
                <div class="app" enable$="[[item.status]]" wait$="[[!item.status]]">
                    <div class="option">
                        <paper-icon-button class="paperLink" item="[[item]]" on-tap="mangeApp" icon="settings"></paper-icon-button>
                    </div>
                    <div class="item" on-tap="redirect" item="[[item]]">
                        <iron-image style="width:150px; height:150px; border-radius: 10px;" sizing="cover" src="[[item.icon_url]]"></iron-image>
                    </div>
                    <div class="item" on-tap="redirect" item="[[item]]">
                        [[item.app_name]]
                    </div>
                    <!--<div class="item" hidden$="[[!item.allowMange]]">

                        <paper-icon-button class="paperLink" item="[[item]]" on-tap="mangeApp" icon="settings"></paper-icon-button>
                        <paper-icon-button class="paperLink" path="app-role" item="[[item]]" on-tap="gotoPath" icon="lock"></paper-icon-button>
                        <paper-icon-button class="paperLink" path="app-user" item="[[item]]" on-tap="gotoPath" icon="supervisor-account"></paper-icon-button>

                    </div>-->
                </div>
            </template>
        </div>



    </template>
    <script>
        Polymer({
            is: 'my-app-list',
            behaviors: [ReduxBehavior],
            properties: {
                list: {
                    statePath: 'myApp.list'
                }
            },
            redirect: function (e) {
                var item = e.currentTarget.item;
                if (item.status) {
                    //  window.location.href = item.allow_callback_url;
                    var url = item.allow_callback_url;
                    window.open(url, '_blank');
                }
            },
            gotoPath: function (e) {
                var path = e.currentTarget.getAttribute('path');
                var app_id = e.currentTarget.item.id;
                console.log(`/${path}/${app_id}`);
                this.fire('nylon-change-page', { path: `/${path}/${app_id}` })
            },
            mangeApp: function (e) {
                this.dispatchAction('MY_APP_SELECT', e.currentTarget.item.id)
            },
            toIndex: function (index) {
                return index + 1
            },
            mergeQuery: function (index, id) {
                return index + id
            }
        });
    </script>
</dom-module>